(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{632:function(e,t,a){e.exports=a.p+"assets/img/kms_tm_ledger_01.c82fa13e.jpg"},633:function(e,t,a){e.exports=a.p+"assets/img/kms_tm_ledger_02.66681d16.jpg"},905:function(e,t,a){"use strict";a.r(t);var r=a(1),o=Object(r.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"tendermint-kms-ledger"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#tendermint-kms-ledger"}},[e._v("#")]),e._v(" Tendermint KMS + Ledger")]),e._v(" "),r("p",{attrs:{synopsis:""}},[e._v("Set up Tendermint KMS with the Tendermint Ledger app")]),e._v(" "),r("h2",{attrs:{id:"pre-requisites"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisites"}},[e._v("#")]),e._v(" Pre-requisites")]),e._v(" "),r("ul",[r("li",{attrs:{prereq:""}},[r("a",{attrs:{href:"https://shop.ledger.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ledger device"),r("OutboundLink")],1)]),e._v(" "),r("li",{attrs:{prereq:""}},[r("a",{attrs:{href:"https://www.ledger.com/ledger-live",target:"_blank",rel:"noopener noreferrer"}},[e._v("Install Ledger Live"),r("OutboundLink")],1)])]),e._v(" "),r("h2",{attrs:{id:"checklist"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#checklist"}},[e._v("#")]),e._v(" Checklist")]),e._v(" "),r("div",{staticClass:"custom-block warning"},[r("p",[e._v("ðŸš§  The following instructions are a brief walkthrough and not a comprehensive guideline. You should consider and research more about the "),r("RouterLink",{attrs:{to:"/validators/security/security.html"}},[e._v("security implications")]),e._v(" of activating an external KMS.")],1)]),e._v(" "),r("ul",[r("li",[e._v("âœ… Ledger "),r("a",{attrs:{href:"https://shop.ledger.com/pages/ledger-nano-x",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nano X"),r("OutboundLink")],1),e._v(" or "),r("a",{attrs:{href:"https://shop.ledger.com/products/ledger-nano-s",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nano S"),r("OutboundLink")],1),e._v(" device (compare "),r("a",{attrs:{href:"https://shop.ledger.com/pages/hardware-wallets-comparison",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),r("OutboundLink")],1),e._v(")")]),e._v(" "),r("li",[e._v("âœ… "),r("a",{attrs:{href:"https://www.ledger.com/ledger-live",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ledger Live"),r("OutboundLink")],1),e._v(" installed")]),e._v(" "),r("li",[e._v("âœ… Tendermint app installed (only in "),r("code",[e._v("Developer Mode")]),e._v(")")]),e._v(" "),r("li",[e._v("âœ… Latest Versions (Firmware and Tendermint app)")])]),e._v(" "),r("h2",{attrs:{id:"tendermint-validator-app-for-ledger-devices"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#tendermint-validator-app-for-ledger-devices"}},[e._v("#")]),e._v(" Tendermint Validator app (for Ledger devices)")]),e._v(" "),r("div",{staticClass:"custom-block danger"},[r("p",[e._v("ðŸš¨"),r("strong",[e._v("IMPORTANT")]),e._v(": KMS and Ledger Tendermint app are currently work in progress. Details may vary. Use under "),r("strong",[e._v("your own risk")])])]),e._v(" "),r("p",[e._v("You should be able to find the Tendermint app in Ledger Live.")]),e._v(" "),r("div",{staticClass:"custom-block tip"},[r("p",[e._v("You will need to enable "),r("code",[e._v("Developer Mode")]),e._v(" in Ledger Live "),r("code",[e._v("Settings")]),e._v(" in order to find the app.")])]),e._v(" "),r("h2",{attrs:{id:"kms-configuration"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#kms-configuration"}},[e._v("#")]),e._v(" KMS configuration")]),e._v(" "),r("p",[e._v("In this section, we will configure a KMS to use a Ledger device running the Tendermint Validator App.")]),e._v(" "),r("h3",{attrs:{id:"config-file"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#config-file"}},[e._v("#")]),e._v(" Config file")]),e._v(" "),r("p",[e._v("You can find other configuration examples "),r("a",{attrs:{href:"https://github.com/iqlusioninc/tmkms/blob/master/tmkms.toml.example",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),r("OutboundLink")],1)]),e._v(" "),r("ul",[r("li",[r("p",[e._v("Create a "),r("code",[e._v("~/.tmkms/tmkms.toml")]),e._v(" file with the following content (use an adequate "),r("code",[e._v("chain_id")]),e._v(")")]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"toml",base64:"IyBFeGFtcGxlIEtNUyBjb25maWd1cmF0aW9uIGZpbGUKW1t2YWxpZGF0b3JdXQphZGRyID0gJnF1b3Q7dGNwOi8vbG9jYWxob3N0OjI2NjU4JnF1b3Q7ICAgICAgICAgICAgICAgICAgIyBvciAmcXVvdDt1bml4Oi8vL3BhdGgvdG8vc29ja2V0JnF1b3Q7CmNoYWluX2lkID0gJnF1b3Q7ZXZtb3NfOTAwMS0xJnF1b3Q7CnJlY29ubmVjdCA9IHRydWUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgdHJ1ZSBpcyB0aGUgZGVmYXVsdApzZWNyZXRfa2V5ID0gJnF1b3Q7fi8udG1rbXMvc2VjcmV0X2Nvbm5lY3Rpb24ua2V5JnF1b3Q7CgpbW3Byb3ZpZGVycy5sZWRnZXJdXQpjaGFpbl9pZHMgPSBbJnF1b3Q7ZXZtb3NfOTAwMS0xJnF1b3Q7XQo="}})],1),e._v(" "),r("li",[r("p",[e._v("Edit "),r("code",[e._v("addr")]),e._v(" to point to your "),r("code",[e._v("evmosd")]),e._v(" instance.")])]),e._v(" "),r("li",[r("p",[e._v("Adjust "),r("code",[e._v("chain-id")]),e._v(" to match your "),r("code",[e._v(".evmosd/config/config.toml")]),e._v(" settings.")])]),e._v(" "),r("li",[r("p",[r("code",[e._v("provider.ledger")]),e._v(" has not additional parameters at the moment, however, it is important that you keep that header to enable the feature.")])])]),e._v(" "),r("p",[r("em",[e._v("Plug your Ledger device and open the Tendermint validator app.")])]),e._v(" "),r("h3",{attrs:{id:"generate-secret-key"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#generate-secret-key"}},[e._v("#")]),e._v(" Generate secret key")]),e._v(" "),r("p",[e._v("Now you need to generate a "),r("code",[e._v("secret_key")]),e._v(":")]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"dG1rbXMga2V5Z2VuIH4vLnRta21zL3NlY3JldF9jb25uZWN0aW9uLmtleQo="}}),e._v(" "),r("h3",{attrs:{id:"retrieve-validator-key"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#retrieve-validator-key"}},[e._v("#")]),e._v(" Retrieve validator key")]),e._v(" "),r("p",[e._v("The last step is to retrieve the validator key that you will use in "),r("code",[e._v("evmosd")]),e._v(".")]),e._v(" "),r("p",[e._v("Start the KMS:")]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"dG1rbXMgc3RhcnQgLWMgfi8udG1rbXMvdG1rbXMudG9tbAo="}}),e._v(" "),r("p",[e._v("The output should look similar to:")]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"text",base64:"MDc6Mjg6MjQgW0lORk9dIHRta21zIDAuMTEuMCBzdGFydGluZyB1cC4uLgowNzoyODoyNCBbSU5GT10gW2tleXJpbmc6bGVkZ2VyOmxlZGdlcl0gYWRkZWQgdmFsaWRhdG9yIGtleSBldm1vc3ZhbGNvbnNwdWIxemNqZHVlcHF5NTNtMzlwcmdwOWR6M256OTZrYWF2M2VsNWUwdGg4bHR3Y2Y4Y3BhdnFkdnB4Z3I1c2xzZDZ3ejZmCjA3OjI4OjI0IFtJTkZPXSBLTVMgbm9kZSBJRDogMUJDMTIzMTRFMkUxQzI5MDE1QjY2MDE3QTM5N0YxNzBDNkVDREU0QQo="}}),e._v(" "),r("p",[e._v("The KMS may complain that it cannot connect to "),r("code",[e._v("evmosd")]),e._v(". That is fine, we will fix it in the next section.\nThis output indicates the validator key linked to this particular device is: "),r("code",[e._v("evmosvalconspub1zcjduepqy53m39prgp9dz3nz96kaav3el5e0th8ltwcf8cpavqdvpxgr5slsd6wz6f")]),e._v("\nTake note of the validator pubkey that appears in your screen. "),r("em",[e._v("We will use it in the next section.")])]),e._v(" "),r("h2",{attrs:{id:"evmos-configuration"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#evmos-configuration"}},[e._v("#")]),e._v(" Evmos configuration")]),e._v(" "),r("p",[e._v("You need to enable KMS access by editing "),r("code",[e._v(".evmosd/config/config.toml")]),e._v(". In this file, modify "),r("code",[e._v("priv_validator_laddr")]),e._v(" to create a listening address/port or a unix socket in "),r("code",[e._v("evmosd")]),e._v(".")]),e._v(" "),r("p",[e._v("For example:")]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"toml",base64:"Li4uCiMgVENQIG9yIFVOSVggc29ja2V0IGFkZHJlc3MgZm9yIFRlbmRlcm1pbnQgdG8gbGlzdGVuIG9uIGZvcgojIGNvbm5lY3Rpb25zIGZyb20gYW4gZXh0ZXJuYWwgUHJpdlZhbGlkYXRvciBwcm9jZXNzCnByaXZfdmFsaWRhdG9yX2xhZGRyID0gJnF1b3Q7dGNwOi8vMTI3LjAuMC4xOjI2NjU4JnF1b3Q7Ci4uLgo="}}),e._v(" "),r("p",[e._v("Let's assume that you have set up your validator account and called it "),r("code",[e._v("kmsval")]),e._v(". You can tell evmosd the key that we've got in the previous section.")]),e._v(" "),r("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"ZXZtb3NkIGdlbnR4IC0tbmFtZSBrbXN2YWwgLS1wdWJrZXkgJmx0O3B1Yl9rZXkmZ3Q7Cg=="}}),e._v(" "),r("p",[e._v("Now start "),r("code",[e._v("evmosd")]),e._v(". You should see that the KMS connects and receives a signature request.")]),e._v(" "),r("p",[e._v("Once the Ledger device receives the first message, it will ask for confirmation that the values are adequate.")]),e._v(" "),r("p",[r("img",{attrs:{src:a(632),alt:'Tendermint Ledger app "Init Validation"'}})]),e._v(" "),r("p",[e._v("Click the right button, if the height and round are correct.")]),e._v(" "),r("p",[e._v("After that, you will see that the KMS will start forwarding all signature requests to the Ledger app:")]),e._v(" "),r("p",[r("img",{attrs:{src:a(633),alt:'Tendermint Ledger app "Proposal"'}})]),e._v(" "),r("div",{staticClass:"custom-block warning"},[r("p",[e._v("The word "),r("code",[e._v("TEST")]),e._v(" in the second picture, second line appears because they were taken on a pre-release version.\nOnce the app as been released in Ledger's app store, this word should NOT appear.")])])],1)}),[],!1,null,null,null);t.default=o.exports}}]);